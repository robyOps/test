:root{
  --bg:255 255 255;--fg:15 23 42;--muted:100 116 139;
  --brand:59 130 246;--ok:5 150 105;--warn:245 158 11;--err:239 68 68;
  --radius:1rem
}
.dark{
  --bg:2 6 23;--fg:226 232 240;--muted:148 163 184;--brand:96 165 250
}
html{font-size:clamp(14px,1.05vw,16px)}
body{background-color:rgb(var(--bg));color:rgb(var(--fg));}

.card{border:1px solid rgba(148,163,184,.25);border-radius:var(--radius);
  background:rgba(255,255,255,.75);backdrop-filter:saturate(140%) blur(6px);
  box-shadow:0 1px 2px rgba(0,0,0,.04)}
.dark .card{background:rgba(2,6,23,.6)}

.btn{display:inline-flex;gap:.5rem;align-items:center;font-weight:600;
  padding:.5rem 1rem;border:1px solid rgba(148,163,184,.35);
  border-radius:calc(var(--radius) - .25rem);transition:transform .06s ease}
.btn:active{transform:translateY(1px)}
.btn-primary{border-color:transparent;background:rgb(var(--brand));color:#fff}
.btn-ghost{border-color:transparent;background:transparent}

.input{width:100%;border:1px solid rgba(148,163,184,.45);background:#fff;
  border-radius:calc(var(--radius) - .25rem);padding:.5rem .75rem}
.input:focus{outline:2px solid rgba(59,130,246,.25);outline-offset:2px}
.dark .input{background:rgba(255,255,255,.03)}

.table{width:100%;border-collapse:separate;border-spacing:0}
.table tr:nth-child(odd){background:rgba(148,163,184,.08)}
.dark .table tr:nth-child(odd){background:rgba(255,255,255,.04)}
.table tr:hover{background:rgba(148,163,184,.14)}
.th{font-weight:600;color:rgb(var(--muted));text-align:left;padding:.75rem}
.td{padding:.75rem;border-top:1px solid rgba(148,163,184,.25)}

.chip{display:inline-flex;gap:.375rem;align-items:center;font-size:.75rem;
  padding:.25rem .5rem;border-radius:999px}
.chip-ok{background:rgba(5,150,105,.15);color:rgb(5,150,105)}
.chip-warn{background:rgba(245,158,11,.18);color:rgb(245,158,11)}
.chip-err{background:rgba(239,68,68,.15);color:rgb(239,68,68)}

header.site{
  position:sticky;top:0;z-index:50;backdrop-filter:blur(8px);
  border-bottom:1px solid rgba(255,255,255,.2);
  background:rgba(255,255,255,.7)
}
.dark header.site{background:rgba(2,6,23,.6)}

.toast-wrap{position:fixed;top:1rem;right:1rem;display:grid;gap:.5rem}
.toast{padding:.75rem 1rem}.toast-info{background:rgba(59,130,246,.15)}
.toast-ok{background:rgba(5,150,105,.15)}.toast-warn{background:rgba(245,158,11,.18)}
.toast-err{background:rgba(239,68,68,.15)}

/* === Normaliza elementos nativos y estados de carga === */
input:not([type="checkbox"]):not([type="radio"]),
select, textarea { font: inherit; }
input:not([type="checkbox"]):not([type="radio"]).input,
select.input, textarea.input { }

table { width:100%; border-collapse:separate; border-spacing:0; }
table thead th { font-weight:600; color:rgb(var(--muted)); padding:.75rem; }
table tbody td { padding:.75rem; border-top:1px solid rgba(148,163,184,.25); }

button { font: inherit; }
button.primary-fallback { border:1px solid transparent; background:rgb(var(--brand)); color:#fff;
  padding:.5rem 1rem; border-radius:calc(var(--radius) - .25rem); }

.btn[aria-busy="true"] { pointer-events:none; opacity:.7 }
.btn[aria-busy="true"]::after {
  content:""; width:1rem; height:1rem; margin-left:.25rem; border-radius:999px;
  border:2px solid currentColor; border-right-color:transparent; display:inline-block;
  animation:spin 1s linear infinite; vertical-align:-2px;
}
@keyframes spin { to { transform:rotate(360deg) } }

@media print {
  header.site, .toast-wrap, #hx-indicator { display:none !important; }
  .card, .btn { box-shadow:none !important; border:0 !important; }
  body { color:#000 !important; }
}

/* ===== Stats / Cards (opt-in) ===== */
.stat-grid{display:grid;gap:1rem;grid-template-columns:repeat(auto-fit,minmax(220px,1fr))}
.stat-card{border:1px solid rgba(148,163,184,.25);border-radius:1rem;background:rgba(255,255,255,.7);
  backdrop-filter:saturate(140%) blur(6px);padding:1rem;display:grid;gap:.5rem}
.dark .stat-card{background:rgba(2,6,23,.6)}
.stat-card .k{font-size:.75rem;color:rgb(var(--muted));font-weight:600;letter-spacing:.02em;text-transform:uppercase}
.stat-card .v{font-size:1.875rem;line-height:1.1;font-weight:800}
.stat-card .delta{display:inline-flex;align-items:center;gap:.375rem;font-weight:600}
.delta.up{color:rgb(var(--ok))}.delta.down{color:rgb(var(--err))}
.spark{height:42px;width:100%}
.progress{height:.5rem;border-radius:999px;background:rgba(148,163,184,.2);overflow:hidden}
.progress>i{display:block;height:100%;width:0;border-radius:inherit;background:rgb(var(--brand))}
.badge{display:inline-flex;align-items:center;gap:.375rem;padding:.25rem .5rem;border-radius:999px;font-size:.75rem;font-weight:600}
.badge.ok{background:rgba(5,150,105,.15);color:rgb(5,150,105)}
.badge.warn{background:rgba(245,158,11,.18);color:rgb(245,158,11)}
.badge.err{background:rgba(239,68,68,.15);color:rgb(239,68,68)}
.toolbar{display:flex;flex-wrap:wrap;gap:.5rem;align-items:center}
.toolbar .spacer{flex:1 1 auto}

/* ===== Listas y estados (auto) ===== */
.row-accent{position:relative}
.row-accent::before{
  content:""; position:absolute; left:0; top:0; bottom:0; width:.25rem; border-radius:.25rem;
  background:rgba(148,163,184,.35)
}
.row-accent.pri-high::before{background:rgba(239,68,68,.8)}
.row-accent.pri-med::before{background:rgba(245,158,11,.9)}
.row-accent.pri-low::before{background:rgba(5,150,105,.85)}

.state-chip{display:inline-flex;align-items:center;gap:.375rem;
  padding:.25rem .5rem;border-radius:999px;font-weight:600;font-size:.75rem}
.state-open{background:rgba(239,68,68,.15);color:rgb(239,68,68)}
.state-inprog{background:rgba(245,158,11,.18);color:rgb(245,158,11)}
.state-closed{background:rgba(5,150,105,.15);color:rgb(5,150,105)}
.state-pending{background:rgba(59,130,246,.15);color:rgb(59,130,246)}

.table thead th.is-col-state{color:rgb(var(--fg))}
.table thead th.is-col-priority{color:rgb(var(--fg))}

.table-toolbar{display:flex;flex-wrap:wrap;gap:.5rem;align-items:center;margin:.5rem 0}
.table-filter{border:1px solid rgba(148,163,184,.45);border-radius:.75rem;padding:.25rem .5rem;background:#fff}
.dark .table-filter{background:rgba(255,255,255,.03)}
/* ===== A11y & Perf ===== */
/* Focus visible solo al navegar con teclado */
:where(a,button,input,select,textarea,[role="button"],[tabindex]):focus{outline:none}
body.user-tabbed :where(a,button,input,select,textarea,[role="button"],[tabindex]):focus-visible{
  outline:3px solid rgba(59,130,246,.5); outline-offset:2px; border-radius:.5rem
}

/* Respeta reduced motion */
@media (prefers-reduced-motion: reduce){
  *{animation-duration:.001ms !important; animation-iteration-count:1 !important; transition-duration:.001ms !important; scroll-behavior:auto !important}
}

/* Mejor contraste opcional */
@media (prefers-contrast: more){
  .btn{border-color:rgba(30,41,59,.6)}
  .input{border-color:rgba(30,41,59,.55)}
}

/* Sticky header offset para anclas */
:target{scroll-margin-top:72px}

/* Scrollbar discreto (no crítico) */
*{scrollbar-width:thin}
*::-webkit-scrollbar{height:8px;width:8px}
*::-webkit-scrollbar-thumb{background:rgba(148,163,184,.6);border-radius:8px}
.dark *::-webkit-scrollbar-thumb{background:rgba(148,163,184,.35)}

/* Tablas grandes: contención para pintar más rápido */
.table{contain:content}

/* Indicador global ARIA */
#hx-indicator{box-shadow:0 2px 8px rgba(0,0,0,.08)}
/* ===== Brand themes via [data-theme] ===== */
:root,[data-theme="default"]{
  --brand:59 130 246;            /* azul */
  --brand-fg:255 255 255;
  --bg:255 255 255; --fg:15 23 42; --muted:100 116 139;
}
[data-theme="emerald"]{ --brand:16 185 129; --brand-fg:255 255 255; }
[data-theme="amber"]{ --brand:245 158 11; --brand-fg:0 0 0; }
[data-theme="rose"]{ --brand:244 63 94; --brand-fg:255 255 255; }
[data-theme="violet"]{ --brand:124 58 237; --brand-fg:255 255 255; }
[data-theme="slate"]{ --brand:71 85 105; --brand-fg:255 255 255; }

.dark[data-theme="default"]{ --bg:2 6 23; --fg:226 232 240; --muted:148 163 184; }
.dark[data-theme="emerald"],
.dark[data-theme="amber"],
.dark[data-theme="rose"],
.dark[data-theme="violet"],
.dark[data-theme="slate"]{
  --bg:2 6 23; --fg:226 232 240; --muted:148 163 184;
}

/* Botones y acentos consumen la marca automáticamente */
.btn-primary{ background:rgb(var(--brand)); color:rgb(var(--brand-fg)); border-color:transparent }
.progress>i{ background:rgb(var(--brand)) }
.toolbar .badge, .badge.ok, .badge.warn, .badge.err { border:0 } /* mantiene look limpio */

/* Vista previa opcional de paleta */
.theme-dot{width:1.25rem;height:1.25rem;border-radius:999px;border:1px solid rgba(0,0,0,.15);display:inline-block;cursor:pointer}
.theme-picker{display:flex;gap:.5rem;align-items:center}
.theme-dot[data-theme="default"]{background:rgb(59 130 246)}
.theme-dot[data-theme="emerald"]{background:rgb(16 185 129)}
.theme-dot[data-theme="amber"]{background:rgb(245 158 11)}
.theme-dot[data-theme="rose"]{background:rgb(244 63 94)}
.theme-dot[data-theme="violet"]{background:rgb(124 58 237)}
.theme-dot[data-theme="slate"]{background:rgb(71 85 105)}
